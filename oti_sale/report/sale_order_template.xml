<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_saleorder_oti">
	<t t-call="web.html_container">
	  <t t-set="data_report_margin_top" t-value="1"/>
	  <t t-set="data_report_header_spacing" t-value="1"/>
	  <t t-foreach="docs" t-as="doc">
		<t t-call="oti_sale.report_saleorder_document_oti" t-lang="doc.partner_id.lang"/>
	  </t>
	</t>
  </template>

  <template id="external_layout_oti">
	<t t-if="not o" t-set="o" t-value="doc"/>
	<div
	t-attf-class="article"
	t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id"
	t-att-data-oe-lang="o and o.env.context.get('lang')">
	  <t t-out="0"/>
	</div>
  </template>

  <template id="first_page_oti">
	<div class="oe_structure"/>
	<div class="row" style="height: 440px;">
	  <div class="col-4">
		<img src="/oti_sale/static/src/img/2.png" style="width:100%"></img>
	  </div>
	  <div class="col-8">
		<img src="/oti_sale/static/src/img/3.png" style="width:100%"></img>
	  </div>
	</div>

	<div class="row">
	  <div class="col=10" style="align:center">
		<img src="/oti_sale/static/src/img/1.png"
			 style="width:80%;margin-right: auto;margin-left: auto;display: block;margin-bottom: -200px;"/>
	  </div>
	</div>

	<div class="row" style="margin-top:40px">
	  <div class="col-1" style="background: #fea400;width: 50px;height: 20px;margin-top: 15px;"/>
	  <div class="col-11" style="text-align:center;">
		<span style="font-weight: bolder;font-size: 35px;text-align: center;font-family: Arial black;color: #626365;">
		  OFFRE FINANCIERE ET TECHNIQUE
		</span>
	  </div>
	</div>

	<div class="row">
	  <div class="col-12" style="text-align:center;margin-top:40px">
		<span t-esc="o.project_subject"
			  style="font-weight: bolder;font-size: 25px;text-align: center;font-family: Arial black;color: #626365;"/>
	  </div>
	</div>

	<div class="row" style="padding-left: 50px;font-size: 20px;">
	  <div class="col-12" style="margin-top:40px;  font-weight: bold;">
		<span style="color: #626365;">Affaire</span>
		&amp;nbsp;
		<span style="color: #626365;" t-esc="o.name"></span>
		&amp;nbsp;
		<span style="color: #626365;">du</span>
		&amp;nbsp;
		<span style="color: #626365;" t-field="o.date_order" t-options='{"format": "dd/MM/yyyy"}'/>
	  </div>
	</div>

	<div class="row" style="padding-left: 50px;font-size: 20px;">
	  <div class="col-12" style="font-weight: bold;">
		<span style="color: #626365;">Client:</span>
		&amp;nbsp;
		<span style="color: #626365;" t-esc="o.partner_id.name"></span>
	  </div>
	</div>

	<div class="row footer o_standard_footer"
		 style="margin-top:40px;font-size: 20px;font-weight: bold;padding-left: 50px;">
	  <div class="col-4 first-page">
		<img src="/oti_sale/static/src/img/5.png" style="width:35%"></img>
	  </div>
	  <div class="col-7 first-page" style="padding-top: 18px;">
		<span style="color: #626365;">Suivi par:</span>
		<t t-if="o.user_id">
		  &amp;nbsp;
		  <span style="color: #626365;" t-esc="o.user_id.name"></span>
		</t>
		<t t-if="o.user_id.partner_id.phone">
		  &amp;nbsp;/&amp;nbsp;
		  <span style="color: #626365;" t-esc="o.user_id.partner_id.phone"></span>
		</t>

	  </div>
	  <div class="col-1 not-first-page" style="padding-top: 7%;">
		<span style="font-weight:normal;font-family:sans-serif;font-size:12px">Page</span>
		<span class="page" style="font-weight:normal;font-family:sans-serif;font-size:12px"/>
		<span style="font-weight:normal;font-family:sans-serif;font-size:12px">/</span>
		<span class="topage" style="font-weight:normal;font-family:sans-serif;font-size:12px"/>
	  </div>
	</div>

	<div style="page-break-after:always;"/>
  </template>

  <template id="sale_template_oti">
	<div class="row" style="padding-top: 100px;">
	  <div class="col-12" style="text-align:center;font-style: italic;font-weight: bolder;">
		<span t-field="o.partner_id"/>&amp;nbsp; - &amp;nbsp;
		<span t-field="o.project_subject"/>
	  </div>

	</div>

	<div class="row">
	  <table style="border-collapse: collapse;font-family: sans-serif;width: 95%;font-size: 12px;">
		<thead style="border: 1px solid;">
		  <tr style="font-style: italic;">
			<th style="border: 1px solid;text-align: center;width:5%;font-weight:normal;padding:5px">
			  <span>Item</span>
			</th>
			<th style="border: 1px solid;text-align: center;width:45%;font-weight:normal;padding:5px">
			  <span>Designation</span>
			</th>
			<th style="border: 1px solid;text-align: center;width:10%;font-weight:normal;padding:5px">
			  <span>Unité</span>
			</th>
			<th style="border: 1px solid;text-align: center;width:10%;font-weight:normal;padding:5px">
			  <span>Quantité</span>
			</th>
			<th style="border: 1px solid;text-align: center;width:15%;font-weight:normal;padding:5px">
			  <span>Prix unitaire</span>
			</th>
			<th style="border: 1px solid;text-align: center;width:15%;font-weight:normal;padding:5px">
			  <span>Montant</span>
			</th>
		  </tr>

		</thead>
		<tbody>
		  <t t-set="current_subtotal" t-value="0"/>

		  <t t-foreach="o.order_line" t-as="line" t-key="line_index">
			<t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"/>
			<t t-if="not line.display_type">
			  <tr>
				<td style="border: 1px solid;text-align: center; padding: 5px;">
				  <span t-esc="line.item"></span>
				</td>
				<td style="border: 1px solid;padding:5px;font-style: italic;">
				  <span t-esc="line.name"></span>
				</td>
				<td style="border: 1px solid;text-align: center;padding:5px">
				  <span t-esc="line.product_uom.name"></span>
				</td>
				<td style="border: 1px solid;text-align: center;padding:5px">
				  <span t-field="line.product_uom_qty"></span>
				</td>
				<td style="border: 1px solid;text-align: end;padding:5px">
				  <span t-esc="line.price_unit"
						t-options='{"widget": "float", "decimal_precision": "Product Price"}'></span>
				</td>
				<td style="border: 1px solid;text-align: end;padding:5px">
				  <span t-esc="line.price_subtotal"
						t-options='{"widget": "float", "decimal_precision": "Product Price"}'></span>
				</td>
			  </tr>
			</t>
			<t t-elif="line.display_type == 'line_section'">
			  <td name="td_section_line" colspan="99" style="border: 1px solid;padding: 5px;">
				<span t-field="line.name"/>
			  </td>
			  <t t-set="current_section" t-value="line"/>
			  <t t-set="current_subtotal" t-value="0"/>
			</t>
			<t
			t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
			  <tr>
				<td name="td_section_subtotal" colspan="99" style="border: 1px solid;text-align: end; padding: 5px;">
				  <strong class="mr16">Sous-total:</strong>
				  <span
				  t-out="current_subtotal"
				  t-options='{"widget": "float", "decimal_precision": "Product Price"}'
				  />
				</td>
			  </tr>
			</t>
		  </t>

		  <tr>
			<td></td>
			<td></td>
			<td></td>
			<td colspan="2" style="border: 2px solid;text-align: end;padding:5px">
			  <span style="font-weight:bolder">MONTANT TOTAL</span>
			</td>
			<td style="border: 2px solid;text-align: end;padding:5px">
			  <span t-esc="o.amount_untaxed"
					t-options='{"widget": "float", "decimal_precision": "Product Price"}'
					style="font-weight:bolder"></span>
			</td>
		  </tr>
		  <tr>
			<td></td>
			<td></td>
			<td></td>
			<td colspan="2" style="border: 2px solid;text-align: end;padding:5px">
			  <span style="font-weight:bolder">TVA 20%</span>
			</td>
			<td style="border: 2px solid;text-align: end;padding:5px">
			  <span t-esc="o.amount_tax" t-options='{"widget": "float", "decimal_precision": "Product Price"}'
					style="font-weight:bolder"></span>
			</td>
		  </tr>
		  <tr>
			<td></td>
			<td></td>
			<td></td>
			<td colspan="2" style="border: 2px solid;text-align: end;padding:5px">
			  <span style="font-weight:bolder">MONTANT TOTAL AVEC TVA</span>
			</td>
			<td style="border: 2px solid;text-align: end;padding:5px">
			  <span t-esc="o.amount_total" t-options='{"widget": "float", "decimal_precision": "Product Price"}'
					style="font-weight:bolder"></span>
			</td>
		  </tr>
		</tbody>
	  </table>
	</div>
	<div class="row" style="padding-top: 30px;font-size: 12px;font-family: sans-serif;">
	  <div class="col-12" style="border: 2px solid;width: 95%;">
		<span>Arrété le présent devis à un montant Hors TVA de</span>&amp;nbsp;
		<span t-esc="o.amount_total_text" style="font-weight:bolder"></span>
		<span style="font-weight:bolder">(</span>
		<span style="font-weight:bolder" t-esc="o.amount_untaxed"
			  t-options='{"widget": "float", "decimal_precision": "Product Price"}'></span>&amp;nbsp;
		<span style="font-weight:bolder">ARIARY). La taxe sur la Valeur Ajoutée de 20% sera facturée
		  en sus.
		</span>
	  </div>

	</div>
	<div class="row">
	  <span t-field="o.note" style="font-size: 12px;font-family: sans-serif;"/>
	</div>
	<div class="row">
	  <div class="col-9"/>
	  <div class="col-3" style="text-align:start">
		<table>
		  <tr style="height:120px">
			<td style="page-break-inside: avoid;">
			  <span style="font-size: 12px;font-family: sans-serif;font-weight:normal">Fait à Antananarivo le</span>
			  <!--<span t-out="o.date_order.strftime('%d %B %Y')"-->
					<!--style="font-size: 12px;font-family: sans-serif;font-weight:normal"/>-->
			  <span  t-esc="context_timestamp(o.date_order).strftime('%d %B %Y')" style="font-size: 12px;font-family: sans-serif;font-weight:normal"/>
			</td>
		  </tr>
		  <tr>
			<td style="page-break-inside: avoid;">
			  <span style="font-size: 12px;font-family: sans-serif;font-weight:bolder">Hary ANDRIANTEFIHASINA</span>
			</td>
		  </tr>
		  <tr>
			<td style="page-break-inside: avoid;">
			  <span style="font-size: 12px;font-family: sans-serif;font-weight:bolder">General Manager</span>
			</td>
		  </tr>
		</table>

	  </div>
	</div>
  </template>

  <template id="report_saleorder_document_oti">
	<div class="page">
	  <t t-call="oti_sale.external_layout_oti">
		<t t-if="not o" t-set="o" t-value="doc"/>
		<t t-call="oti_sale.first_page_oti"/>
		<t t-call="oti_sale.sale_template_oti"/>
	  </t>
	</div>
  </template>

  <!--<template id="report_sale_order_document_body_oti">-->
  <!--<div class="page">-->
  <!--<t t-call="oti_sale.external_layout_oti">-->
  <!--<t t-if="not o" t-set="o" t-value="doc"/>-->
  <!--<t t-call="oti_sale.sale_template_oti"/>-->
  <!--</t>-->
  <!--</div>-->
  <!--</template>-->

</odoo>